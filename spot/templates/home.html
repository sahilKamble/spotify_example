{% extends 'main.html' %}
{% block content %}

{% if user.is_authenticated %}
<div class="card">
    <div class="card-body">
        
        Select a playlist for tracking by clicking on the tick button besides a playlist's name<br>
        Youtube playlist :  {{ yt_tracking }}<br>
        Spotify playlist :   {{ sp_tracking }}<br>
    
    </div>
</div>

{% if yt_tracking and sp_tracking %}
<div class="card card-body">
            <a class="btn btn-success" href="{% url 'update_list'%}">Add tracks from YouTube playlist to Spotify playlist</a>
</div>
{% endif %}

{% if not playlists or not ytlists%}
<div class="card">
    <div class="card-body mx-auto">
        <div class="row">
            {% if not playlists %}
            <div class="col-sm-6">
                    <a class="btn btn-success" href="{% url 'spotify' %}"><i class="fab fa-spotify"></i> Get Spotify Playlists</a> <br>
            </div>
            {% endif %}
            {% if not ytlists %}
            <div class="col-sm-6">
                    {% load socialaccount %}
                    <a class="btn btn-danger" href="{% provider_login_url 'google' process='connect' next='/' %}"><i class="fab fa-youtube"></i>Get Youtube playlists</a> <br>
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endif %}

{% if playlists %}
<div class="card">
    <div class="card-body">
        <h4>Here's your Spotify playlists</h4><br>
        {% for key, playlist in playlists.items %}
        <div class="row">
            <div class="col">
                <a class="btn btn-dark" data-toggle="collapse" href="#{{ key }}">{{ playlist.name }}</a>
                <a class="btn btn-primary" href="{% url 'sp_playlist' key %}"><i class="fas fa-check"></i></a>
                <div id="{{ key }}" class="panel-collapse collapse">
                    <ul class="list-group">
                    {% for track in playlist.tracks %}
                        <li class="list-group-item">{{ track }}</li>
                    {% endfor %}
                    </ul><br>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endif %}

{% if ytlists %}
<div class="card">
    <div class="card-body">
  
        <h4>Here's your Youtube playlists</h4>
        {% for key, playlist in ytlists.items %}
        <div class="row">
            <div class="col">
                <a class="btn btn-dark" data-toggle="collapse" href="#{{ key }}">{{ playlist.name }}</a>
                <a class="btn btn-primary" href="{% url 'yt_playlist' key %}"><i class="fas fa-check"></i></a>
                <div id="{{ key }}" class="panel-collapse collapse">
                    <ul class="list-group">
                    {% for track in playlist.tracks %}
                        <li class="list-group-item">{{ track }}</li>
                    {% endfor %}
                    </ul><br>
                </div>
            {% endfor %}
    <br>
    <a class="btn btn-danger" href="{% url 'create_playlist' %}">Create New Playlist Instead</a><br>
    <a href="{% url 'update' %}">Scratch credentials</a><br>

{% endif %}
{% else %}
    <a href="{% url 'account_signup' %}">Signup</a><br>
    <a href="{% url 'account_login' %}">Login</a><br>
{% endif %}
  </div>
</div>
{% endblock %}
